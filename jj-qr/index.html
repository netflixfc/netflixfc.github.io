<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JaiJai Parking Service</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Sarabun', sans-serif; background-color: #f0f2f5; }
        .main-container { display: flex; flex-direction: column; min-height: 100vh; }
        .card-qr { border: none; box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
        .footer-action { background-color: #ffffff; border-top: 1px solid #dee2e6; }
    </style>
</head>
<body>
    <div class="main-container">
        <header class="text-center p-3 bg-white shadow-sm">
            <h1 class="h4 text-primary fw-bold mb-0">üöó JaiJai Parking Service</h1>
            <p id="current-time" class="text-muted small mb-0"></p>
        </header>

        <main class="container my-4 text-center">
            <div class="card card-qr mx-auto" style="max-width: 380px;">
                <div class="card-header bg-primary text-white"><h5 class="mb-0">‡∏Ñ‡πà‡∏≤‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£ 50 ‡∏ö‡∏≤‡∏ó</h5></div>
                <div id="main-card-body" class="card-body p-4">
                    <p class="card-text">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏™‡πÅ‡∏Å‡∏ô QR Code ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</p>
                    <img src="https://res.cloudinary.com/dcwjok3nu/image/upload/v1759045158/carrent/qr.jpg" class="img-fluid rounded my-3" alt="Payment QR Code">
                    
                    <div id="alert-message" class="alert mt-3 d-none" role="alert"></div>
                </div>
            </div>
        </main>

        <footer id="footer" class="p-3 footer-action">
            <div id="initial-view" class="d-grid gap-2" style="max-width: 380px; margin: auto;">
                 <button id="confirm-btn" class="btn btn-success btn-lg fw-bold">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡πÅ‡∏•‡∏∞‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
            </div>
            
            <div id="next-actions-view" class="d-none" style="max-width: 380px; margin: auto;">
                <p class="text-center fw-bold">‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡πà‡∏≠:</p>
                <div class="d-grid gap-2">
                    <button id="cctv-btn" class="btn btn-primary">‡∏î‡∏π‡∏†‡∏≤‡∏û‡∏à‡∏≤‡∏Å‡∏Å‡∏•‡πâ‡∏≠‡∏á CCTV</button>
                    <button id="log-btn" class="btn btn-secondary">‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡∏´‡∏ô‡πâ‡∏≤‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
                </div>
                <hr>
                <button id="reset-btn" class="btn btn-outline-danger w-100">‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å (‡∏£‡∏±‡∏ö‡∏Ñ‡∏±‡∏ô‡πÉ‡∏´‡∏°‡πà)</button>
            </div>
        </footer>
    </div>

    <script>
        // --- Get elements ---
        const confirmBtn = document.getElementById('confirm-btn');
        const alertMessage = document.getElementById('alert-message');
        const timeDisplay = document.getElementById('current-time');
        const initialView = document.getElementById('initial-view');
        const nextActionsView = document.getElementById('next-actions-view');
        const cctvBtn = document.getElementById('cctv-btn');
        const logBtn = document.getElementById('log-btn');
        const resetBtn = document.getElementById('reset-btn');

        // --- Clock ---
        function updateTime() {
            timeDisplay.textContent = `‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà ${new Date().toLocaleDateString('th-TH', { dateStyle: 'long'})} | ‡πÄ‡∏ß‡∏•‡∏≤ ${new Date().toLocaleTimeString('th-TH')}`;
        }
        setInterval(updateTime, 1000);
        updateTime();

        // --- Event Listeners ---
        confirmBtn.addEventListener('click', () => {
            confirmBtn.disabled = true;
            confirmBtn.textContent = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å...';
            
            const transactionId = 'LOG-' + Date.now();
            console.log(`Payment confirmed. Logging transaction: ${transactionId}`);
            
            setTimeout(() => {
                // Show success message
                alertMessage.textContent = '‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! ‚úÖ';
                alertMessage.className = 'alert alert-success mt-3';

                // Swap the button views
                initialView.classList.add('d-none');
                nextActionsView.classList.remove('d-none');
            }, 1000); // Simulate 1 sec delay
        });

        cctvBtn.addEventListener('click', () => {
            // **‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç:** ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô 'http://192.168.1.100' ‡πÄ‡∏õ‡πá‡∏ô IP Address ‡∏à‡∏£‡∏¥‡∏á‡∏Ç‡∏≠‡∏á‡∏Å‡∏•‡πâ‡∏≠‡∏á CCTV ‡∏´‡∏£‡∏∑‡∏≠ NVR ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì
            console.log("Redirecting to CCTV stream...");
            window.open('http://192.168.1.100', '_blank'); // Open in new tab
        });

        logBtn.addEventListener('click', () => {
            console.log("Redirecting to log page...");
            window.location.href = 'log.html'; // Open in the same tab
        });

        resetBtn.addEventListener('click', () => {
            // Reset everything for the next car
            alertMessage.className = 'd-none';
            nextActionsView.classList.add('d-none');
            initialView.classList.remove('d-none');
            confirmBtn.disabled = false;
            confirmBtn.textContent = '‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡πÅ‡∏•‡∏∞‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•';
        });
    </script>
</body>
</html>
