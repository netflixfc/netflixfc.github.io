<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Shop GTS - NetflixFC</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    .product { border: 1px solid #ddd; padding: 12px; margin: 8px 0; }
    .price { font-weight: bold; color: #111; }
    .original { text-decoration: line-through; color: #888; margin-left: 8px; }
    #cart { position: fixed; right: 20px; top: 20px; border: 1px solid #ccc; padding: 10px; background: #fff; }
    button { padding: 8px 12px; cursor: pointer; }
  </style>
</head>
<body>
  <h1>Shop GTS</h1>
  <p>All prices are shown in THB (฿). Checkout supports PromptPay (experimental) and QR code payment confirmation.</p>

  <div id="products"></div>

  <div id="cart">
    <h3>Cart</h3>
    <ul id="cart-items"></ul>
    <div>Total: <span id="cart-total">฿0.00</span></div>
    <div style="margin-top:8px;"><a id="checkout" href="/shop-gts/payment.html">Go to payment</a></div>
  </div>

  <script>
    // Products now include THB prices: priceThb and optional originalThb
    const products = [
      { id: 1, title: 'GTS T-shirt', priceThb: 350.00, originalThb: 450.00, desc: 'Comfortable cotton tee' },
      { id: 2, title: 'GTS Sticker Pack', priceThb: 120.00, originalThb: 150.00, desc: 'Set of 5 stickers' },
      { id: 3, title: 'GTS Hoodie', priceThb: 1500.00, originalThb: 1800.00, desc: 'Warm zip hoodie' }
    ];

    const cart = [];

    function formatThb(amount) {
      return '฿' + Number(amount).toLocaleString('en-US', {minimumFractionDigits:2, maximumFractionDigits:2});
    }

    function renderProducts() {
      const el = document.getElementById('products');
      el.innerHTML = '';
      products.forEach(p => {
        const d = document.createElement('div');
        d.className = 'product';
        d.innerHTML = `<h2>${p.title}</h2>
          <p>${p.desc}</p>
          <div class="price">${formatThb(p.priceThb)}${p.originalThb ? '<span class="original">'+formatThb(p.originalThb)+'</span>' : ''}</div>
          <div style="margin-top:8px;"><button onclick="addToCart(${p.id})">Add to cart</button></div>`;
        el.appendChild(d);
      });
    }

    function addToCart(productId) {
      const product = products.find(p => p.id === productId);
      if (!product) return;
      const existing = cart.find(c => c.id === productId);
      if (existing) {
        existing.qty += 1;
      } else {
        cart.push({ id: product.id, title: product.title, priceThb: product.priceThb, qty: 1 });
      }
      renderCart();
    }

    function renderCart() {
      const items = document.getElementById('cart-items');
      items.innerHTML = '';
      let total = 0;
      cart.forEach(item => {
        const li = document.createElement('li');
        li.textContent = `${item.title} x${item.qty} - ${formatThb(item.priceThb * item.qty)}`;
        items.appendChild(li);
        total += item.priceThb * item.qty;
      });
      document.getElementById('cart-total').textContent = formatThb(total);
      // save pending cart to session so payment page can fetch it
      sessionStorage.setItem('shopgts_cart', JSON.stringify(cart));
    }

    // Initialize
    renderProducts();
    renderCart();
  </script>
</body>
</html>
